{"ast":null,"code":"\"use strict\"; // Keep all classes requiring libsodium-js in one file as having multiple\n// requiring of the libsodium-wrappers module currently crashes browsers\n//\n// libsodium.js API: https://gist.github.com/webmaster128/b2dbe6d54d36dd168c9fabf441b9b09c\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst libsodium_wrappers_1 = __importDefault(require(\"libsodium-wrappers\"));\n\nclass Argon2id {\n  static async execute(password, salt, options) {\n    await libsodium_wrappers_1.default.ready;\n    return libsodium_wrappers_1.default.crypto_pwhash(options.outputLength, password, salt, // libsodium only supports 16 byte salts and will throw when you don't respect that\n    options.opsLimit, options.memLimitKib * 1024, libsodium_wrappers_1.default.crypto_pwhash_ALG_ARGON2ID13);\n  }\n\n}\n\nexports.Argon2id = Argon2id;\n\nclass Ed25519Keypair {\n  constructor(privkey, pubkey) {\n    this.privkey = privkey;\n    this.pubkey = pubkey;\n  } // a libsodium privkey has the format `<ed25519 privkey> + <ed25519 pubkey>`\n\n\n  static fromLibsodiumPrivkey(libsodiumPrivkey) {\n    if (libsodiumPrivkey.length !== 64) {\n      throw new Error(`Unexpected key length ${libsodiumPrivkey.length}. Must be 64.`);\n    }\n\n    return new Ed25519Keypair(libsodiumPrivkey.slice(0, 32), libsodiumPrivkey.slice(32, 64));\n  }\n\n  toLibsodiumPrivkey() {\n    return new Uint8Array([...this.privkey, ...this.pubkey]);\n  }\n\n}\n\nexports.Ed25519Keypair = Ed25519Keypair;\n\nclass Ed25519 {\n  /**\n   * Generates a keypair deterministically from a given 32 bytes seed.\n   *\n   * This seed equals the Ed25519 private key.\n   * For implementation details see crypto_sign_seed_keypair in\n   * https://download.libsodium.org/doc/public-key_cryptography/public-key_signatures.html\n   * and diagram on https://blog.mozilla.org/warner/2011/11/29/ed25519-keys/\n   */\n  static async makeKeypair(seed) {\n    await libsodium_wrappers_1.default.ready;\n    const keypair = libsodium_wrappers_1.default.crypto_sign_seed_keypair(seed);\n    return Ed25519Keypair.fromLibsodiumPrivkey(keypair.privateKey);\n  }\n\n  static async createSignature(message, keyPair) {\n    await libsodium_wrappers_1.default.ready;\n    return libsodium_wrappers_1.default.crypto_sign_detached(message, keyPair.toLibsodiumPrivkey());\n  }\n\n  static async verifySignature(signature, message, pubkey) {\n    await libsodium_wrappers_1.default.ready;\n    return libsodium_wrappers_1.default.crypto_sign_verify_detached(signature, message, pubkey);\n  }\n\n}\n\nexports.Ed25519 = Ed25519;\n\nclass Xchacha20poly1305Ietf {\n  static async encrypt(message, key, nonce) {\n    await libsodium_wrappers_1.default.ready;\n    const additionalData = null;\n    return libsodium_wrappers_1.default.crypto_aead_xchacha20poly1305_ietf_encrypt(message, additionalData, null, // secret nonce: unused and should be null (https://download.libsodium.org/doc/secret-key_cryptography/aead/chacha20-poly1305/xchacha20-poly1305_construction)\n    nonce, key);\n  }\n\n  static async decrypt(ciphertext, key, nonce) {\n    await libsodium_wrappers_1.default.ready;\n    const additionalData = null;\n    return libsodium_wrappers_1.default.crypto_aead_xchacha20poly1305_ietf_decrypt(null, // secret nonce: unused and should be null (https://download.libsodium.org/doc/secret-key_cryptography/aead/chacha20-poly1305/xchacha20-poly1305_construction)\n    ciphertext, additionalData, nonce, key);\n  }\n\n}\n\nexports.Xchacha20poly1305Ietf = Xchacha20poly1305Ietf;","map":{"version":3,"sources":["../src/libsodium.ts"],"names":[],"mappings":"cAAA;AACA;AACA;AACA;;;;;;;;;;;;AAEA,MAAA,oBAAA,GAAA,eAAA,CAAA,OAAA,CAAA,oBAAA,CAAA,CAAA;;AAkBA,MAAa,QAAb,CAAqB;AACQ,eAAP,OAAO,CACzB,QADyB,EAEzB,IAFyB,EAGzB,OAHyB,EAGD;AAExB,UAAM,oBAAA,CAAA,OAAA,CAAO,KAAb;AACA,WAAO,oBAAA,CAAA,OAAA,CAAO,aAAP,CACL,OAAO,CAAC,YADH,EAEL,QAFK,EAGL,IAHK,EAGC;AACN,IAAA,OAAO,CAAC,QAJH,EAKL,OAAO,CAAC,WAAR,GAAsB,IALjB,EAML,oBAAA,CAAA,OAAA,CAAO,4BANF,CAAP;AAQD;;AAfkB;;AAArB,OAAA,CAAA,QAAA,GAAA,QAAA;;AAkBA,MAAa,cAAb,CAA2B;AAYzB,EAAA,WAAA,CAAmB,OAAnB,EAAwC,MAAxC,EAA0D;AACxD,SAAK,OAAL,GAAe,OAAf;AACA,SAAK,MAAL,GAAc,MAAd;AACD,GAfwB,CACzB;;;AACkC,SAApB,oBAAoB,CAAC,gBAAD,EAA6B;AAC7D,QAAI,gBAAgB,CAAC,MAAjB,KAA4B,EAAhC,EAAoC;AAClC,YAAM,IAAI,KAAJ,CAAU,yBAAyB,gBAAgB,CAAC,MAAM,eAA1D,CAAN;AACD;;AACD,WAAO,IAAI,cAAJ,CAAmB,gBAAgB,CAAC,KAAjB,CAAuB,CAAvB,EAA0B,EAA1B,CAAnB,EAAkD,gBAAgB,CAAC,KAAjB,CAAuB,EAAvB,EAA2B,EAA3B,CAAlD,CAAP;AACD;;AAUM,EAAA,kBAAkB,GAAA;AACvB,WAAO,IAAI,UAAJ,CAAe,CAAC,GAAG,KAAK,OAAT,EAAkB,GAAG,KAAK,MAA1B,CAAf,CAAP;AACD;;AAnBwB;;AAA3B,OAAA,CAAA,cAAA,GAAA,cAAA;;AAsBA,MAAa,OAAb,CAAoB;AAClB;;;;;;;AAOG;AAC4B,eAAX,WAAW,CAAC,IAAD,EAAiB;AAC9C,UAAM,oBAAA,CAAA,OAAA,CAAO,KAAb;AACA,UAAM,OAAO,GAAG,oBAAA,CAAA,OAAA,CAAO,wBAAP,CAAgC,IAAhC,CAAhB;AACA,WAAO,cAAc,CAAC,oBAAf,CAAoC,OAAO,CAAC,UAA5C,CAAP;AACD;;AAEkC,eAAf,eAAe,CAAC,OAAD,EAAsB,OAAtB,EAA6C;AAC9E,UAAM,oBAAA,CAAA,OAAA,CAAO,KAAb;AACA,WAAO,oBAAA,CAAA,OAAA,CAAO,oBAAP,CAA4B,OAA5B,EAAqC,OAAO,CAAC,kBAAR,EAArC,CAAP;AACD;;AAEkC,eAAf,eAAe,CACjC,SADiC,EAEjC,OAFiC,EAGjC,MAHiC,EAGf;AAElB,UAAM,oBAAA,CAAA,OAAA,CAAO,KAAb;AACA,WAAO,oBAAA,CAAA,OAAA,CAAO,2BAAP,CAAmC,SAAnC,EAA8C,OAA9C,EAAuD,MAAvD,CAAP;AACD;;AA3BiB;;AAApB,OAAA,CAAA,OAAA,GAAA,OAAA;;AA8BA,MAAa,qBAAb,CAAkC;AACL,eAAP,OAAO,CACzB,OADyB,EAEzB,GAFyB,EAGzB,KAHyB,EAGQ;AAEjC,UAAM,oBAAA,CAAA,OAAA,CAAO,KAAb;AAEA,UAAM,cAAc,GAAG,IAAvB;AAEA,WAAO,oBAAA,CAAA,OAAA,CAAO,0CAAP,CACL,OADK,EAEL,cAFK,EAGL,IAHK,EAGC;AACN,IAAA,KAJK,EAKL,GALK,CAAP;AAOD;;AAE0B,eAAP,OAAO,CACzB,UADyB,EAEzB,GAFyB,EAGzB,KAHyB,EAGQ;AAEjC,UAAM,oBAAA,CAAA,OAAA,CAAO,KAAb;AAEA,UAAM,cAAc,GAAG,IAAvB;AAEA,WAAO,oBAAA,CAAA,OAAA,CAAO,0CAAP,CACL,IADK,EACC;AACN,IAAA,UAFK,EAGL,cAHK,EAIL,KAJK,EAKL,GALK,CAAP;AAOD;;AAnC+B;;AAAlC,OAAA,CAAA,qBAAA,GAAA,qBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\n// Keep all classes requiring libsodium-js in one file as having multiple\n// requiring of the libsodium-wrappers module currently crashes browsers\n//\n// libsodium.js API: https://gist.github.com/webmaster128/b2dbe6d54d36dd168c9fabf441b9b09c\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst libsodium_wrappers_1 = __importDefault(require(\"libsodium-wrappers\"));\nclass Argon2id {\n    static async execute(password, salt, options) {\n        await libsodium_wrappers_1.default.ready;\n        return libsodium_wrappers_1.default.crypto_pwhash(options.outputLength, password, salt, // libsodium only supports 16 byte salts and will throw when you don't respect that\n        options.opsLimit, options.memLimitKib * 1024, libsodium_wrappers_1.default.crypto_pwhash_ALG_ARGON2ID13);\n    }\n}\nexports.Argon2id = Argon2id;\nclass Ed25519Keypair {\n    constructor(privkey, pubkey) {\n        this.privkey = privkey;\n        this.pubkey = pubkey;\n    }\n    // a libsodium privkey has the format `<ed25519 privkey> + <ed25519 pubkey>`\n    static fromLibsodiumPrivkey(libsodiumPrivkey) {\n        if (libsodiumPrivkey.length !== 64) {\n            throw new Error(`Unexpected key length ${libsodiumPrivkey.length}. Must be 64.`);\n        }\n        return new Ed25519Keypair(libsodiumPrivkey.slice(0, 32), libsodiumPrivkey.slice(32, 64));\n    }\n    toLibsodiumPrivkey() {\n        return new Uint8Array([...this.privkey, ...this.pubkey]);\n    }\n}\nexports.Ed25519Keypair = Ed25519Keypair;\nclass Ed25519 {\n    /**\n     * Generates a keypair deterministically from a given 32 bytes seed.\n     *\n     * This seed equals the Ed25519 private key.\n     * For implementation details see crypto_sign_seed_keypair in\n     * https://download.libsodium.org/doc/public-key_cryptography/public-key_signatures.html\n     * and diagram on https://blog.mozilla.org/warner/2011/11/29/ed25519-keys/\n     */\n    static async makeKeypair(seed) {\n        await libsodium_wrappers_1.default.ready;\n        const keypair = libsodium_wrappers_1.default.crypto_sign_seed_keypair(seed);\n        return Ed25519Keypair.fromLibsodiumPrivkey(keypair.privateKey);\n    }\n    static async createSignature(message, keyPair) {\n        await libsodium_wrappers_1.default.ready;\n        return libsodium_wrappers_1.default.crypto_sign_detached(message, keyPair.toLibsodiumPrivkey());\n    }\n    static async verifySignature(signature, message, pubkey) {\n        await libsodium_wrappers_1.default.ready;\n        return libsodium_wrappers_1.default.crypto_sign_verify_detached(signature, message, pubkey);\n    }\n}\nexports.Ed25519 = Ed25519;\nclass Xchacha20poly1305Ietf {\n    static async encrypt(message, key, nonce) {\n        await libsodium_wrappers_1.default.ready;\n        const additionalData = null;\n        return libsodium_wrappers_1.default.crypto_aead_xchacha20poly1305_ietf_encrypt(message, additionalData, null, // secret nonce: unused and should be null (https://download.libsodium.org/doc/secret-key_cryptography/aead/chacha20-poly1305/xchacha20-poly1305_construction)\n        nonce, key);\n    }\n    static async decrypt(ciphertext, key, nonce) {\n        await libsodium_wrappers_1.default.ready;\n        const additionalData = null;\n        return libsodium_wrappers_1.default.crypto_aead_xchacha20poly1305_ietf_decrypt(null, // secret nonce: unused and should be null (https://download.libsodium.org/doc/secret-key_cryptography/aead/chacha20-poly1305/xchacha20-poly1305_construction)\n        ciphertext, additionalData, nonce, key);\n    }\n}\nexports.Xchacha20poly1305Ietf = Xchacha20poly1305Ietf;\n//# sourceMappingURL=libsodium.js.map"]},"metadata":{},"sourceType":"script"}